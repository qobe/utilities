#$query = "select SMS_R_System.Name, SMS_R_System.DistinguishedName from  SMS_R_System inner join SMS_G_System_VIDEO_CONTROLLER on SMS_G_System_VIDEO_CONTROLLER.ResourceId = SMS_R_System.ResourceId WHERE SMS_G_System_Video_Controller.Description LIKE '%Standard VGA Graphics Adapter%'"
#$query = "select SMS_R_System.Name, SMS_R_System.DistinguishedName from  SMS_R_System inner join SMS_G_System_VIDEO_CONTROLLER on SMS_G_System_VIDEO_CONTROLLER.ResourceId = SMS_R_System.ResourceId WHERE SMS_G_System_Video_Controller.Description LIKE '%NVIDIA%'"
#$query = "select SMS_R_SYSTEM.ResourceID,SMS_R_SYSTEM.ResourceType,SMS_R_SYSTEM.Name,SMS_R_SYSTEM.SMSUniqueIdentifier,SMS_R_SYSTEM.ResourceDomainORWorkgroup,SMS_R_SYSTEM.Client from SMS_R_System inner join SMS_G_System_VIDEO_CONTROLLER on SMS_G_System_VIDEO_CONTROLLER.ResourceId = SMS_R_System.ResourceId  where not  (SMS_G_System_VIDEO_CONTROLLER.Description LIKE '%AMD%'  OR  SMS_G_System_VIDEO_CONTROLLER.Description LIKE '%ATI%'  OR  SMS_G_System_VIDEO_CONTROLLER.Description LIKE '%Intel%')"
$query = "select SMS_G_System_VIDEO_CONTROLLER.PNPDeviceID from  SMS_R_System inner join SMS_G_System_VIDEO_CONTROLLER on SMS_G_System_VIDEO_CONTROLLER.ResourceID = SMS_R_System.ResourceId WHERE SMS_G_System_VIDEO_CONTROLLER.PNPDeviceID LIKE 'SMS_G_System_VIDEO_CONTROLLER.PNPDeviceID'"
$collection = get-wmiobject -query $query -namespace "root\sms\site_P01" -ComputerName "wvu-adcm01-2.wvu-ad.wvu.edu"
$collection
